# Диаграмма последовательности системная (с классами)

## Диаграмма последовательности: Подача заявки пользователем

![image](https://github.com/user-attachments/assets/9489494b-fb6f-4fd5-8bb4-c7b238d3d274)


### Основной сценарий:
 - Пользователь вызывает метод submitApplication контроллера UserController.
 - Контроллер вызывает метод createApplication у ApplicationService, передавая userId и serviceId.
 - ApplicationService запрашивает данные пользователя через UserService по ID.
 - UserService обращается к UserRepository, который делает запрос в БД: SELECT * FROM User WHERE id = userId.
 - БД возвращает данные пользователя.
 - ApplicationService выполняет валидацию пользователя с помощью метода validateUser.
 - Затем ApplicationService получает данные сервиса через ServiceRepository, делая запрос в БД: SELECT * FROM Service 
   WHERE id = serviceId.
 - ApplicationService валидирует полученный сервис с помощью метода validateService.
 - Если данные валидны:
 - Создаётся объект заявки.
 - ApplicationRepository сохраняет заявку в БД с запросом INSERT INTO Application.
 - БД подтверждает сохранение.
 - UserController возвращает пользователю сообщение: "Заявка создана".
 - Если данные невалидны:
 - ApplicationService возвращает сообщение об ошибке.
 - UserController возвращает пользователю сообщение: "Ошибка: невалидные данные".
 
## Диаграмма последовательности: Изменение персональных параметров 

![image](https://github.com/user-attachments/assets/e69c5743-5114-47b7-810b-738d50293689)





### Основной сценарий:
 - Пользователь вызывает метод updatePersonalData контроллера UserController, передавая userId и новые данные (newData).
 - Контроллер вызывает метод updateUser у UserService, передавая данные пользователя и новые данные.
 - Сервис UserService запрашивает данные пользователя через UserRepository по ID пользователя.
 - UserRepository выполняет запрос в БД с использованием запроса SELECT User WHERE id=userId.
 - БД возвращает данные пользователя в UserRepository.
 - UserRepository передает данные пользователя в UserService.
 - Внутри UserService происходит валидация данных с помощью метода validate.
 - Если данные валидны, происходит сохранение обновленных данных пользователя через UserRepository с запросом UPDATE 
   User.
 - БД подтверждает успешное обновление данных пользователя.
 - Контроллер UserController получает обновленные данные пользователя и передает их обратно пользователю с сообщением 
   "Данные обновлены".



## Диаграмма последовательности: Отмена заявки 

![image](https://github.com/user-attachments/assets/b81d8caa-0b29-4f1d-8f76-d0558679174f)




### Основной сценарий:
 - Пользователь вызывает метод cancelApplication контроллера UserController, передавая appId заявки для отмены.
 - Контроллер вызывает метод cancelApplication у ApplicationService, передавая appId заявки.
 - Сервис ApplicationService запрашивает информацию о заявке через ApplicationRepository по ID заявки.
 - ApplicationRepository выполняет запрос в БД с использованием запроса SELECT Application WHERE id=appId.
 - БД возвращает данные заявки в ApplicationRepository.
 - ApplicationRepository передает данные заявки в ApplicationService.
 - В сервисе ApplicationService происходит валидация, проверяется, может ли заявка быть отменена (например, по статусу).
 - Если заявка допустима для отмены, происходит обновление ее статуса на CANCELED через ApplicationRepository.
 - ApplicationRepository выполняет запрос в БД с использованием запроса UPDATE Application SET status='CANCELED'.
 - БД подтверждает успешное обновление статуса заявки.
 - Контроллер UserController получает информацию об успешной отмене заявки и сообщает об этом пользователю с сообщением 
   "Заявка отменена".


## Диаграмма последовательности: Просмотр списка услуг
![image](https://github.com/user-attachments/assets/3ae3543c-5403-4650-8e10-0a8ecc5314b9)




### Основной сценарий:
 - Пользователь вызывает метод getAvailableServices контроллера ServiceController, чтобы получить доступные услуги.
 - Контроллер ServiceController вызывает метод getActiveServices у сервиса ServiceService.
 - Сервис ServiceService запрашивает активные услуги через ServiceRepository с использованием метода 
   findByActiveTrue().
 - ServiceRepository выполняет запрос в БД с использованием запроса SELECT Service WHERE active=true.
 - БД возвращает список активных услуг.
 - ServiceRepository передает полученный список услуг в ServiceService.
 - В сервисе ServiceService выполняется промежуточная валидация: проверяется, не пуст ли список услуг.
 - Если список пуст, сервис сообщает контроллеру, что доступных услуг нет, и контроллер передает пользователю 
   сообщение "Нет доступных услуг".
 - Если список не пуст, сервис возвращает список активных услуг контроллеру.
 - Контроллер ServiceController отправляет список услуг обратно пользователю с сообщением "Список услуг".


## Диаграмма последовательности: Просмотр статуса 
![image](https://github.com/user-attachments/assets/23af7b66-6b44-4580-acc9-65394fade65c)




### Основной сценарий:
 - Пользователь вызывает метод getStatus контроллера UserController для получения статуса заявки с идентификатором 
   appId.
 - Контроллер UserController вызывает метод getApplicationStatus у сервиса ApplicationService.
 - Сервис ApplicationService запрашивает заявку по appId через ApplicationRepository с методом findById.
 - В сервисе ApplicationService выполняется промежуточная валидация, проверяется существование заявки с данным appId.
 - Если заявка не найдена, сервис сообщает контроллеру о том, что заявка не найдена, и контроллер передает 
   пользователю сообщение "Заявка не найдена".
 - Если заявка найдена, контроллер продолжает выполнение. ApplicationRepository выполняет запрос в БД с помощью SELECT 
   Application WHERE id=appId.
 - БД возвращает найденную заявку.
 - ApplicationRepository передает заявку обратно в ApplicationService.
 - Сервис ApplicationService возвращает статус заявки контроллеру.
 - Контроллер UserController передает пользователю сообщение о текущем статусе заявки, например "Статус: В обработке".


 

## Диаграмма последовательности: Добавление правила со сторони администратора

![image](https://github.com/user-attachments/assets/ea6183a6-7bd9-4f7d-b039-c6b209f223b3)




### Основной сценарий:
 - Администратор вызывает метод addRule в контроллере AdminController, передавая идентификатор услуги (serviceId) и 
   данные правила (ruleData).
 - Контроллер AdminController передает эти данные в сервис AdminService с помощью метода addRule.
 - В сервисе AdminService выполняется промежуточная валидация данных правила, включая проверку параметров.
 - Если данные правила некорректны, сервис сообщает контроллеру об ошибке и передает сообщение "Некорректные данные 
   правила".
 - Если данные корректны, сервис передает данные правила в репозиторий RuleRepository для сохранения.
 - Репозиторий RuleRepository выполняет запрос в БД для вставки нового правила с помощью команды INSERT Rule.
 - БД возвращает информацию о сохраненном правиле.
 - Репозиторий возвращает сохраненное правило в сервис AdminService.
 - Сервис AdminService передает результат контроллеру.
 - Контроллер AdminController сообщает администратору, что правило успешно добавлено, с сообщением "Правило добавлено".


## Диаграмма последовательности: Обработка заявки госслужащим

![image](https://github.com/user-attachments/assets/b2a098d5-78d3-45fa-a617-a6a21911d2f9)




### Основной сценарий:
 - Госслужащий вызывает метод processApplication в контроллере GovernmentController, передавая идентификатор заявки 
   (appId).
 - Контроллер GovernmentController передает запрос на обработку заявки в сервис GovernmentService с помощью метода 
   processApplication.
 - В сервисе GovernmentService выполняется запрос в репозиторий ApplicationRepository для получения заявки по 
   идентификатору (appId).
 - Репозиторий ApplicationRepository выполняет запрос в БД и извлекает информацию о заявке.
 - Сервис GovernmentService выполняет промежуточную валидацию, проверяя статус заявки перед дальнейшей обработкой.
 - Если статус заявки не соответствует необходимым условиям, сервис сообщает контроллеру, что заявка находится в 
   недопустимом статусе.
 - Если статус заявки правильный, сервис передает заявку в RuleService для дальнейшей проверки по правилам.
 - RuleService выполняет запрос в БД для получения списка правил, связанных с услугой из заявки.
 - После выполнения валидации правил, сервис GovernmentService снова проверяет статус заявки через репозиторий 
   ApplicationRepository.
 - Если статус заявки все еще допустим, сервис обновляет статус заявки на "PROCESSED" через репозиторий 
   ApplicationRepository.
 - Репозиторий выполняет запрос в БД для обновления статуса заявки.
 - Репозиторий сообщает сервису, что заявка была обновлена.
 - Сервис передает обработанную заявку обратно в контроллер GovernmentController.
 - Контроллер сообщает госслужащему, что заявка была успешно обработана.





 

