# Диаграмма последовательности системная (с классами)

## Диаграмма последовательности: Подача заявки пользователем

![image](https://github.com/user-attachments/assets/a23bf0aa-26cd-4869-bd38-869eccf18a0c)

## Actor: User
 - Пользователь инициирует процесс подачи заявки, вызывая метод submitApplication(userId, serviceId) на UserController. Это действие подразумевает, что пользователь хочет создать заявку на определённую услугу, используя свой идентификатор и идентификатор услуги.

## UserController (UC)
 - UserController получает запрос от пользователя и вызывает метод getUserApplications(userId) из UserService. Этот шаг необходим для того, чтобы проверить, есть ли у пользователя уже активные или ожидающие заявки. Это может быть полезно, чтобы предотвратить создание дублирующихся заявок для одного пользователя на ту же услугу или просто чтобы предоставить пользователю информацию о его текущих заявках.
   После этого UserController ожидает результат от UserService, который будет в виде списка заявок пользователя (например, для проверки, что у пользователя нет заявки на эту услугу или просто для отображения всех заявок).
   В случае успеха UserService возвращает список заявок (List<Application>) обратно в UserController.

## UserController (UC)
 - После того как UserController получил список заявок от UserService, он продолжает обработку и вызывает метод createApplication(userId, serviceId) из ApplicationService для создания новой заявки.
   Этот шаг инициирует процесс создания новой заявки с указанными пользователем идентификаторами: userId (пользователь) и serviceId (услуга). ApplicationService будет отвечать за всю бизнес-логику, связанную с созданием новой заявки, например, проверку данных, инициализацию и сохранение новой заявки в базе данных.

## ApplicationService (AS)
 - ApplicationService вызывает метод save(application) на ApplicationRepository. Этот шаг необходим для сохранения новой заявки в базе данных. После того как объект заявки создан и заполнен всеми необходимыми данными (например, статусом, датой подачи, пользователем, услугой и другими атрибутами), заявка сохраняется через репозиторий.
   ApplicationRepository — это слой, который управляет взаимодействием с базой данных. Метод save() сохраняет новую заявку в базе данных и подтверждает успешное сохранение, возвращая сохранённый объект заявки.

## ApplicationRepository (AR)
 - После того как заявка была успешно сохранена в базе данных, ApplicationRepository возвращает объект Application обратно в ApplicationService. Этот объект теперь включает в себя все данные заявки, включая уникальный идентификатор, который автоматически присваивается базе данных.

## ApplicationService (AS)
 - После того как заявка была сохранена, ApplicationService передает объект заявки обратно в UserController. Этот шаг подтверждает, что заявка была успешно создана и сохранена.

## UserController (UC)
 - Наконец, UserController возвращает ответ пользователю в виде объекта ResponseEntity<Application>. Это стандартный способ в Spring Framework для отправки ответа с дополнительной информацией о статусе операции (например, успешное создание или ошибка). Объект Application будет содержать все данные новой заявки, и пользователь сможет увидеть её или получить подтверждение успешного создания.
После того как заявка была успешно сохранена в базе данных, ApplicationRepository возвращает объект Application обратно в ApplicationService. Этот объект теперь включает в себя все данные заявки, включая уникальный идентификатор, который автоматически присваивается базе данных.

## ApplicationService (AS)
После того как заявка была сохранена, ApplicationService передает объект заявки обратно в UserController. Этот шаг подтверждает, что заявка была успешно создана и сохранена.

## Диаграмма последовательности: Получение заявок пользователя

![image](https://github.com/user-attachments/assets/795490cf-ba1c-40f1-96b7-3ab8e84db639)

## Пользователь (User) 
 - Отправляет запрос на получение всех заявок с определённым статусом.
## UserController (UC) 
 - Получает запрос и передает его в UserService (US) для обработки.

## UserService (US)
 - Использует UserRepository (UR) для поиска информации о пользователе по его ID.

## UserRepository (UR) 
 - Возвращает данные пользователя.

## Затем UserService (US) 
 - Запрашивает все заявки с определённым статусом (например, "submitted") у ApplicationRepository (AR).

## ApplicationRepository (AR) 
 - Возвращает список заявок.

## UserService (US) 
 - Передает полученный список в UserController (UC).

## UserController (UC) 
 - Отправляет список заявок обратно пользователю в виде ResponseEntity<List<Application>>.

## Диаграмма последовательности: Обработка заявки государственным служащим

 ![image](https://github.com/user-attachments/assets/290d1621-58b7-43ef-84d6-41f3e74ca028)
 
## Государственный служащий (GovernmentEmployee) 
  - Инициирует процесс обработки заявки, отправляя запрос с ID заявки в GovernmentController (GC).

## GovernmentController (GC) 
  - Передает запрос на обработку заявки в GovernmentService (GS).

## GovernmentService (GS) 
  - Использует ApplicationRepository (AR) для получения данных заявки по ее ID с помощью метода findById(applicationId).

## ApplicationRepository (AR) 
  - Возвращает объект Application, содержащий данные заявки.

## GovernmentService (GS)
  - Затем запрашивает информацию о государственном служащем, связанном с аккаунтом, через GovernmentEmployeeRepository (GER), используя метод findByAccount(accountId).

## GovernmentEmployeeRepository (GER) 
  - Возвращает данные о государственном служащем.

## GovernmentService (GS) 
  - Обновляет данные заявки в ApplicationRepository (AR) с помощью метода update(application).

## ApplicationRepository (AR) 
  - Подтверждает успешное обновление (возвращает void).

## GovernmentService (GS) 
  - Отправляет подтверждение в GovernmentController (GC).

## GovernmentController (GC) 
  - Отправляет ответ с состоянием операции (ResponseEntity<Void>) обратно государственному служащему.

## Диаграмма последовательности: Создание нового сервиса администратором

![image](https://github.com/user-attachments/assets/46e621d0-7c61-43bd-861e-6fa163a907e4)

## Администратор (Administrator)
 - Отправляет запрос на создание нового сервиса с данными сервиса (через объект serviceDto) в AdminController (AC).

## AdminController (AC) 
 - Передает этот запрос в AdminService (AS) для обработки.

## AdminService (AS) 
 - Вызывает метод save(Service) в ServiceRepository (SR) для сохранения нового сервиса в базе данных.

## ServiceRepository (SR) 
 - Сохраняет сервис и возвращает сохраненный объект Service обратно в AdminService (AS).

## AdminService (AS) 
 - Отправляет сохраненный сервис обратно в AdminController (AC).

## AdminController (AC) 
 - Отправляет ответ с сохраненным объектом Service в виде ResponseEntity<Service> обратно администратору, подтверждая успешное создание сервиса.

## Диаграмма последовательности: Добавление нового правила для сервиса администратором

 ![image](https://github.com/user-attachments/assets/2d43eac0-f56d-4bf5-b063-2808f7c1aec2)

## Описание диаграммы:
## Администратор (Administrator) 
 - Отправляет запрос на добавление нового правила для сервиса с идентификатором serviceId и данными правила (ruleDto) в AdminController (AC).

## AdminController (AC)
 - Передает запрос в AdminService (AS) для обработки.

## AdminService (AS) 
 - Использует ServiceRepository (SR) для получения сервиса по serviceId с помощью метода findById(serviceId).

## ServiceRepository (SR)
 - Возвращает объект Service обратно в AdminService (AS).

## AdminService (AS) 
 - Создает новое правило на основе полученных данных и вызывает метод save(rule) в RuleRepository (RR) для сохранения этого правила.

## RuleRepository (RR)
 - Сохраняет правило и возвращает сохраненный объект Rule обратно в AdminService (AS).

## AdminService (AS) 
 - Отправляет сохраненное правило обратно в AdminController (AC).

## AdminController (AC)
 - Отправляет ответ с сохраненным объектом Rule в виде ResponseEntity<Rule> обратно администратору, подтверждая успешное добавление правила.











UserController (UC)
Наконец, UserController возвращает ответ пользователю в виде объекта ResponseEntity<Application>. Это стандартный способ в Spring Framework для отправки ответа с дополнительной информацией о статусе операции (например, успешное создание или ошибка). Объект Application будет содержать все данные новой заявки, и пользователь сможет увидеть её или получить подтверждение успешного создания.
